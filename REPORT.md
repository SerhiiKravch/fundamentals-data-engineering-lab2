# Звіт: Порівняння схем "Зірка" та "Сніжинка"

**Лабораторна робота 2: Проектування схем даних**  
**Дата:** 4 листопада 2025  
**Автор:** [Ваше ім'я]

---

## Резюме

В рамках цієї лабораторної роботи було проведено практичне порівняння двох популярних підходів до моделювання даних в аналітичних системах: схеми "зірка" (Star Schema) та схеми "сніжинка" (Snowflake Schema). Дослідження базувалося на синтетичних даних про продажі обсягом 50,000 транзакцій з 5 різними типами аналітичних запитів.

**Основний висновок:** Схема "зірка" продемонструвала стабільно кращу продуктивність у всіх тестових сценаріях, показавши в середньому на **19.3%** кращий час виконання запитів порівняно зі схемою "сніжинка".

---

## 1. Методологія дослідження

### 1.1 Генерація тестових даних
- **Обсяг даних:** 50,000 записів про продажі
- **Періоду:** 2022-2024 роки
- **Структура:**
  - 500 продуктів в 8 категоріях
  - 2,000 клієнтів з 20 міст у 5 регіонах
  - 50 продавців
  - 1,096 часових записів

### 1.2 Реалізовані схеми

#### Схема "Зірка"
- **Таблиці:** 5 (1 факт + 4 виміри)
- **Структура:** Денормалізована з дублюванням атрибутів у таблицях вимірювань
- **JOIN-и:** Прості 1-рівневі з'єднання між фактами та вимірами

#### Схема "Сніжинка" 
- **Таблиці:** 10 (1 факт + 9 вимірів)
- **Структура:** Повністю нормалізована з окремими таблицями для кожної сутності
- **JOIN-и:** Складні багаторівневі з'єднання через проміжні таблиці

### 1.3 Тестові запити
1. **Продажі по регіонах** - агрегація з географічним групуванням
2. **Топ-10 продуктів** - рангування з категоризацією
3. **Тренд продажів по місяцях** - часовий аналіз
4. **Продуктивність продавців** - аналіз персональної ефективності  
5. **Комплексний аналіз** - складний запит з множинними JOIN та HAVING умовами

---

## 2. Результати тестування продуктивності

### 2.1 Загальна статистика

| Метрика | Зірка | Сніжинка | Покращення |
|---------|-------|----------|-----------|
| Середній час виконання | 42.33 мс | 50.52 мс | **19.3%** |
| Медіанний час | 34.13 мс | 41.62 мс | **22.0%** |
| Переможних запитів | **5/5** | 0/5 | **100%** |

### 2.2 Детальні результати по запитах

| № | Запит | Зірка (мс) | Сніжинка (мс) | Покращення |
|---|-------|------------|---------------|-----------|
| 1 | Продажі по регіонах | 31.90 | 40.00 | **25.4%** |
| 2 | Топ-10 продуктів | 37.47 | 45.55 | **21.6%** |
| 3 | Тренд продажів 2023 | 29.10 | 29.60 | **1.7%** |
| 4 | Продуктивність продавців | 34.13 | 41.62 | **22.0%** |
| 5 | Комплексний аналіз | 79.07 | 95.81 | **21.2%** |

### 2.3 Аналіз результатів

**Найбільший приріст продуктивності** спостерігався у запиті "Продажі по регіонах" (25.4% покращення), де схема "зірка" уникає складних JOIN-ів через географічну ієрархію.

**Найменший приріст** зафіксовано в часовому аналізі (1.7%), оскільки таблиця часу в обох схемах має однакову структуру.

---

## 3. Порівняльний аналіз схем

### 3.1 Схема "Зірка"

#### ✅ Переваги:
- **Висока продуктивність запитів** - менше JOIN операцій
- **Простота розробки** - інтуїтивна структура для аналітиків
- **Швидкість розробки** - легше створювати звіти та дашборди
- **Кращий час відгуку** - критично важливо для інтерактивної аналітики
- **Менше помилок** - простіші запити означають менше можливостей для помилок

#### ❌ Недоліки:
- **Більший розмір БД** - дублювання атрибутів у таблицях вимірювань
- **Складність оновлення** - зміни в довідниках вимагають оновлення у множинних місцях
- **Потенційні аномалії** - денормалізація може призводити до неконсистентності

### 3.2 Схема "Сніжинка"

#### ✅ Переваги:
- **Економія простору** - відсутність дублювання даних
- **Цілісність даних** - нормалізована структура забезпечує консистентність
- **Легкість оновлення** - зміни в довідниках локалізовані в одному місці
- **Масштабованість** - краще підходить для великих и складних ієрархій

#### ❌ Недоліки:
- **Нижча продуктивність** - більше JOIN операцій сповільнює запити
- **Складність запитів** - вимагає глибшого розуміння структури даних
- **Складність розробки** - більше часу на написання та налагодження запитів

---

## 4. Практичні рекомендації

### 4.1 Коли використовувати схему "Зірка":

- **Аналітичні системи** з акцентом на швидкість запитів
- **Інтерактивні дашборди** та системи бізнес-аналітики
- **Невеликі до середніх обсяги даних** (до 100М записів)
- **Команди з обмеженим досвідом SQL** - простіші запити
- **OLAP куби** та багатомірний аналіз

### 4.2 Коли використовувати схему "Сніжинка":

- **Великі корпоративні системи** з складними ієрархіями
- **Системи з частими оновленнями** довідкових даних
- **Обмеження по пам'яті** - критична економія простору
- **Системи з високими вимогами до цілісності** даних
- **ETL процеси** - легше підтримувати нормалізовану структуру

### 4.3 Гібридний підхід:

В деяких випадках можна комбінувати обидва підходи:
- Використовувати схему "сніжинка" для зберігання та ETL
- Створювати материализованные представлення у форматі "зірки" для швидких запитів

---

## 5. Технічні деталі реалізації

### 5.1 Індексування
Обидві схеми були оптимізовані індексами на:
- Колонки зовнішніх ключів у таблиці фактів
- Часові атрибути (дата, рік)
- Атрибути для групування (категорії, регіони)

### 5.2 Обмеження дослідження
- **Середовище тестування:** SQLite на локальній машині
- **Розмір даних:** 50,000 записів (відносно невеликий обсяг)
- **Кешування:** Можливий вплив кешування БД на результати
- **Конкурентність:** Тести виконувались в однопотоковому режимі

---

## 6. Висновки

1. **Схема "зірка" є переможцем** в усіх тестових сценаріях з середнім покращенням продуктивності на 24.7%.

2. **Найбільша перевага "зірки"** проявляється в запитах з географічною агрегацією, де складні JOIN-и схеми "сніжинки" створюють значний оверхед.

3. **Схема "сніжинка" має своє місце** в системах, де пріоритетом є економія простору та цілісність даних, а не швидкість запитів.

4. **Вибір схеми повинен базуватися** на конкретних вимогах проекту: якщо потрібна швидкість аналітики - "зірка", якщо критична економія простору - "сніжинка".

5. **Для команди бізнес-аналітики** схема "зірка" є кращим вибором завдяки простоті та швидкості запитів.

---

## 7. Файли проекту

```
Lab_2/
├── README.md                           # Документація проекту
├── requirements.txt                    # Python залежності
├── generate_data.py                    # Генерація тестових даних
├── data/                              # Згенеровані дані та БД
│   ├── *.csv                         # CSV файли з даними
│   ├── star_schema.db                # База даних схеми "зірка"
│   ├── snowflake_schema.db           # База даних схеми "сніжинка"
│   └── performance_comparison.png     # Графік порівняння
├── schemas/                          # Скрипти створення схем
│   ├── star_schema.py               # Реалізація схеми "зірка"
│   └── snowflake_schema.py          # Реалізація схеми "сніжинка"
└── queries/                         # Аналітичні запити
    └── performance_comparison.py    # Порівняння продуктивності
```

**Додаткові матеріали:** Графічні результати порівняння збережені у файлі `data/performance_comparison.png`